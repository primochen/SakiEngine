// ğŸ¤– è‡ªåŠ¨ç”Ÿæˆçš„æ¨¡å—æ³¨å†Œæ–‡ä»¶
// æ­¤æ–‡ä»¶ç”±æ„å»ºå·¥å…·è‡ªåŠ¨ç”Ÿæˆï¼Œè¯·å‹¿æ‰‹åŠ¨ç¼–è¾‘ï¼
// è¦æ›´æ–°æ­¤æ–‡ä»¶ï¼Œè¯·è¿è¡Œ: dart tool/generate_modules.dart

import 'package:sakiengine/src/core/project_module_loader.dart';

// è‡ªåŠ¨å‘ç°çš„æ¨¡å—å¯¼å…¥
import 'package:sakiengine/soranouta/soranouta_module.dart';

/// è‡ªåŠ¨ç”Ÿæˆçš„æ¨¡å—å·¥å‚æ˜ å°„è¡¨
final Map<String, GameModuleFactory> _autoGeneratedModules = {
  'soranouta': () => SoranoutaModule(),
};

/// è‡ªåŠ¨æ³¨å†Œæ‰€æœ‰å‘ç°çš„æ¨¡å—
void registerAllDiscoveredModules() {
  final loader = ProjectModuleLoader();
  
  print('[GeneratedModuleRegistry] ğŸ¤– å¼€å§‹æ³¨å†Œè‡ªåŠ¨å‘ç°çš„æ¨¡å—');
  
  for (final entry in _autoGeneratedModules.entries) {
    try {
      loader.registerModule(entry.key, entry.value);
      print('[GeneratedModuleRegistry] âœ… æ³¨å†Œæ¨¡å—: ${entry.key}');
    } catch (e) {
      print('[GeneratedModuleRegistry] âŒ æ³¨å†Œæ¨¡å— ${entry.key} å¤±è´¥: $e');
    }
  }
  
  print('[GeneratedModuleRegistry] ğŸ¯ å®Œæˆï¼å·²æ³¨å†Œ ${_autoGeneratedModules.length} ä¸ªæ¨¡å—');
}
