# 睁眼转场效果 - 可视化说明

## 动画流程图解

```
时间轴:  0%        25%        50%        75%       100%
         │          │          │          │          │
         ▼          ▼          ▼          ▼          ▼

闭眼阶段 ───────────────────────────┤
(0%-50%)                          │
                                  │
场景切换 ─────────────────────────►│
                                  │
睁眼阶段                           ├───────────────────
(50%-100%)                         │
```

## 视觉效果示意

### 阶段 1: 开始 (0%)
```
┌─────────────────────┐
│                     │
│                     │
│   原场景完全可见     │
│                     │
│                     │
└─────────────────────┘
```

### 阶段 2: 闭眼中 (25%)
```
┌─────────────────────┐
│███████████████████  │  ← 上遮罩向下
│                     │
│   原场景逐渐被遮    │
│                     │
│███████████████████  │  ← 下遮罩向上
└─────────────────────┘
```

### 阶段 3: 完全闭眼 (50%) - 场景切换时刻
```
┌─────────────────────┐
│███████████████████  │
│███████████████████  │
│███████████████████  │  ← 完全黑屏
│███████████████████  │
│███████████████████  │
└─────────────────────┘
       ⚡ 此时切换到新场景
```

### 阶段 4: 睁眼中 (75%)
```
┌─────────────────────┐
│███████████████████  │  ← 上遮罩向上
│                     │
│   新场景逐渐显示    │
│                     │
│███████████████████  │  ← 下遮罩向下
└─────────────────────┘
```

### 阶段 5: 完全睁眼 (100%)
```
┌─────────────────────┐
│                     │
│                     │
│   新场景完全显示     │
│                     │
│                     │
└─────────────────────┘
```

## 代码实现原理

### 遮罩高度计算
```dart
// 上遮罩: 从顶部向下增长
final topMaskHeight = (screenHeight / 2) * closeProgress;
Rect.fromLTWH(0, 0, screenWidth, topMaskHeight)

// 下遮罩: 从底部向上增长
final bottomMaskHeight = (screenHeight / 2) * closeProgress;
Rect.fromLTWH(0, screenHeight - bottomMaskHeight, screenWidth, bottomMaskHeight)
```

### 动画进度控制
```dart
if (controller.value <= 0.5) {
  // 前半段: 闭眼 (0->1)
  eyeCloseProgress = closeAnimation.value;
} else {
  // 后半段: 睁眼 (1->0)
  eyeCloseProgress = openAnimation.value;
}
```

## 使用示例对照

### 场景: 早晨醒来
```sks
scene bl                    // 黑屏(闭眼状态)
"我缓缓睁开双眼..."
scene bedroom with blink    // 睁眼看到卧室
```

**效果**:
1. 0%-50%: 保持黑屏，然后切换场景到卧室
2. 50%-100%: 上下遮罩移开，露出卧室场景

### 场景: 失去意识后苏醒
```sks
scene bl with fade          // 渐黑(失去意识)
"不知过了多久..."
"我恢复了意识。"
scene hospital with eyeopen // 睁眼发现在医院
```

**效果**: 先淡入黑屏，然后通过睁眼转场显示医院场景

## 与其他转场的视觉对比

### fade (淡入淡出)
```
█████ → ░░░░░ → ▒▒▒▒▒ → ░░░░░ → 场景
(全黑)   (淡出)   (全黑)   (淡入)
```

### diss (溶解)
```
场景A → 场景A+B → 场景B
(直接图片渐变，无黑屏)
```

### wipe (擦除)
```
  ╱       ╱╱      ╱╱╱     ╱╱╱╱    ╱╱╱╱╱
 ╱       ╱╱      ╱╱╱     ╱╱╱╱    ╱╱╱╱╱
(扇形旋转覆盖)
```

### blink (睁眼) ⭐
```
    ▔▔▔         ▔▔▔▔▔       ▔▔▔▔▔▔▔
              →           →
    ___         _____       _______
(上下遮罩移开)
```

## 性能特点

- ✅ **轻量级**: 仅使用 Canvas 绘制矩形
- ✅ **流畅**: 60fps 动画
- ✅ **无加载**: 不需要额外资源
- ✅ **兼容性**: 支持所有平台

---
**提示**: 建议在剧情的关键醒来时刻使用此转场，可以大大增强沉浸感！
